Don't @me for the horrible code